---
title: "hobo_2023"
format: html
editor: source
---

## Load Packages

```{r}

if (!require(librarian)){
  install.packages("librarian")
  library(librarian)
}

# librarian downloads, if not already downloaded, and reads in needed packages
librarian::shelf(tidyverse, here, janitor, lubridate, RPostgres, rstudioapi, DBI, parsedate, stringr, hms,
                 anytime, terra, sp, rgdal, RWmisc, proj4, uuid)

```

## read in all .csv files
```{r}

# clear environment
rm(list=ls())

# slow method for reading csv files

filenames <- gsub("\\.csv$","", list.files(here("data", "hobo_2023", "all")))

for(i in filenames){
  assign(i, read_csv(here("data", "hobo_2023", "all", paste(i, ".csv", sep=""))))
}
```

## Panama

### Combine both Panama files raw
```{r}

raw_comb_panama <- rbind(`Panama_combined_Aug23-Dec23`, `Panama_combined_Nov22-Aug23`) %>% 
  clean_names()

```

### Clean and Pivot
```{r}

clean_panama <- raw_comb_panama %>% 
  select(!c(time_zone, study_area, hobo_name)) %>% 
  rename(temperature_c = temperature,
         light_lux = intensity_lux,
         relative_humidity = rh) %>% 
  mutate(height = str_replace(height, "-", "neg"),
         dew_point_c = NA,
         site = if_else(site == "AltosdePiedra", "altos_de_piedra", site),
         site = if_else(site == "Campestre", "hotel_campestre", site),
         site = if_else(site == "CerroNegro", "cerro_negro", site), # new
         site = if_else(site == "Rabbit", "rabbit_stream", site), # new
         site = if_else(site == "RioBlanco", "rio_blanco", site),
         site = if_else(site == "Tigrero", "rio_tigrero", site))

```


## Penn

### Raw penn
```{r}

raw_penn <- `PA_combined_May23â€“Jun23` %>% 
  clean_names()

```

### Clean and Pivot
```{r}

clean_penn <- raw_penn %>% 
  select(!c(time_zone, study_area, hobo_name)) %>% 
  rename(temperature_c = temperature,
         light_lux = intensity_lux,
         relative_humidity = rh,
         dew_point_c = dew_point) %>% 
  mutate(height = str_replace(height, "-", "neg"),
         site = if_else(site == "Admin", "admin_pond", site),
         site = if_else(site == "Phelps", "phelps_pond", site),
         site = if_else(site == "RV", "rv_pond", site),
         site = if_else(site == "TW", "tryon_weber", site),
         site = if_else(site == "Vorisek", "vorisek_pond", site),
         site = if_else(site == "Wood", "wood_lab_pond", site),
         site = if_else(site == "Tuttle", "tuttle_pond", site))

```


## SN

### Raw SN 
```{r}

raw_sn <- `SierraNevada_combined_Jul23-Oct23` %>% 
  clean_names()

```

### Clean and Pivot
```{r}

clean_sn <- raw_sn %>% 
  select(!c(time_zone, study_area, hobo_name)) %>% 
  rename(temperature_c = temperature,
         light_lux = intensity_lux,
         relative_humidity = rh,
         dew_point_c = dew_point) %>% 
  mutate(height = str_replace(height, "-", "neg"))

```

